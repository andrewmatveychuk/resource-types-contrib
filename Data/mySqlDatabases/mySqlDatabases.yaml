namespace: Radius.Data
types:
  mySqlDatabases:
    description: |
      The Radius.Data/mySqlDatabases Resource Type deploys a MySQL database.

      To deploy a new MySQL database, add the mySqlDatabases resource to the application definition Bicep file.

      param environment string
      resource database 'Radius.Data/mySqlDatabases@2025-08-01-preview' = {
        name: 'mysql'
        properties: {
          application: application
          environment: environment
        }
      }

      To connect your application to the MySQL database, establish a connection from the container to the database resource as shown below.

      @description('Tag to pull for the WordPress container image.')
      param tag string = 'latest'

      var port int = 80

      resource frontend 'Applications.Core/containers@2023-10-01-preview' = {
        name: 'wordpress'
        properties: {
          application: application
          environment: environment
          container: {
            image: 'wordpress:${tag}'
            ports: {
              web: {
                containerPort: port
              }
            }
            env: {
              WORDPRESS_DB_HOST: {
                value: '${database.properties.host}:${database.properties.port}'
              }
              WORDPRESS_DB_USER: {
                value: database.properties.username
              }
              WORDPRESS_DB_PASSWORD: {
                value: database.properties.password
              }
              WORDPRESS_DB_NAME: {
                value: database.properties.database
              }
            }
          }
          connections: {
            database: {
              source: database.id
            }
          }
        }
      }
    apiVersions:
      '2025-08-01-preview':
        schema:
          type: object
          properties:
            environment:
              type: string
              description: "(Required) The Radius EnvironmentID. Typically set by the rad CLI. Typically value should be `environment`"
            application:
              type: string
              description: "(Optional) The Radius Application ID. `myApplication.id` for example."
            database:
              type: string
              description: "(Optional) The name of the database."
            username:
              type: string
              description: "(Optional) The username for connecting to the database."
            version:
              type: string
              enum: ['5.7', '8.0', '8.4']
              description: "(Optional) The major MySQL server version in the X.Y format."
            password:
              type: string
              description: "(Read-only) The password for connecting to the database."
              readOnly: true
            host:
              type: string
              description: "(Read-only) The host name used to connect to the database."
              readOnly: true
            port:
              type: integer
              description: "(Read-only) The port number used to connect to the the database."
              readOnly: true
          required:
          - environment